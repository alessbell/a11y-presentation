{"ast":null,"code":"import { useEffect, useState } from 'react';\nimport { useRouter } from 'next/router';\nimport { useCurrentSlide } from '../context/CurrentSlideContext';\nvar keys = {\n  slide: 'next-mdx-deck-slide',\n  page: 'next-mdx-deck-page'\n};\nexport var useStorage = function useStorage() {\n  var _useCurrentSlide = useCurrentSlide(),\n      currentSlide = _useCurrentSlide.currentSlide,\n      setSlide = _useCurrentSlide.setSlide;\n\n  var router = useRouter();\n  var currentPage = router.query && 'slide' in router.query && parseInt(router.query.slide, 10);\n\n  var _useState = useState(false),\n      focused = _useState[0],\n      setFocused = _useState[1];\n  /**\n   * Checks when user enters (focus) or\n   * leaves (blur) browser window/tab\n   */\n\n\n  var handleFocus = function handleFocus() {\n    return setFocused(true);\n  };\n\n  var handleBlur = function handleBlur() {\n    return setFocused(false);\n  };\n  /**\n   * Updates route or context with local storage data\n   * from event listener\n   * @param {*} e\n   */\n\n\n  var handleStorageChange = function handleStorageChange(e) {\n    var n = parseInt(e.newValue, 10);\n    var syncedSlide = localStorage.getItem(keys.slide); // if (focused) return\n\n    if (Number.isNaN(n)) return;\n\n    switch (e.key) {\n      case keys.page:\n        router.push(\"/slides/\".concat(parseInt(n, 10), \"#\").concat(syncedSlide));\n        break;\n\n      case keys.slide:\n        window.location.hash = \"#\".concat(n);\n        setSlide(n);\n        break;\n\n      default:\n        break;\n    }\n  };\n\n  useEffect(function () {\n    setFocused(document.hasFocus());\n  }, []);\n  useEffect(function () {\n    if (!focused) window.addEventListener('storage', handleStorageChange);\n    window.addEventListener('focus', handleFocus);\n    window.addEventListener('blur', handleBlur);\n    return function () {\n      if (!focused) window.removeEventListener('storage', handleStorageChange);\n      window.removeEventListener('focus', handleFocus);\n      window.removeEventListener('blur', handleBlur);\n    };\n  }, [focused]);\n  /**\n   * Sync localstorage with changes to slides or pages\n   */\n\n  useEffect(function () {\n    if (!focused) return;\n    localStorage.setItem(keys.slide, currentSlide);\n    localStorage.setItem(keys.page, currentPage);\n  }, [focused, currentSlide, currentPage]);\n};\nexport var Storage = function Storage() {\n  useStorage();\n  return false;\n};\nexport default useStorage;","map":null,"metadata":{},"sourceType":"module"}